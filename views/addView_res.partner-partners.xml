<?xml version="1.0"?>
<odoo>
  <data>
    <!-- partners list -->
    <record id="partners_tree" model="ir.ui.view">
      <field name="name">colpari.partners.tree</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>
      <field name="arch" type="xml">
        <tree limit="120" string="Partnerzzz" delete="0" multi_edit="0" sample="1" expand="true">
          <field name="display_name" string="Name"/>
          <field name="is_company" optional="hide" string="Company?" />
          <field name="email" optional="show" />
          <field name="phone_line_number" string="Line" class="o_force_ltr" optional="show"/>
          <field name="colpari_login_name" string="Login" optional="show"/>
          <!-- <field name="user_id" optional="hide" widget="many2one_avatar_user" domain="[('share', '=', False)]"/> -->
          <field name="vat" optional="hide" readonly="1"/>
          <field name="skills" optional="hide" widget="many2many_tags" options="{'color_field': 'color'}"/>
          <field name="category_id" optional="hide" widget="many2many_tags" options="{'color_field': 'color'}"/>
          <field name="company_id" groups="base.group_multi_company" readonly="1" optional="hide" />
          <field name="parent_id" optional="show"/>
          <field name="birthday" optional="show"/>
          <field name="birthday_month_day" optional="hide"/>
          <field name="birthday_month" optional="hide"/>
          <field name="active" optional="hide"/>
          <field name="effective_assigned_projects" optional="hide" widget="many2many_tags" string="Projects" />
          <field name="city" optional="hide"/>
          <field name="state_id" optional="hide" readonly="1"/>
          <field name="country_id" optional="hide" readonly="1"/>
        </tree>
      </field>
    </record>

    <!-- activity view -->
    <record id="partners_activity" model="ir.ui.view">
      <field name="name">colpari.partners.activity</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <activity string="Contacts">
            <field name="id"/>
            <templates>
                <div t-name="activity-box">
                    <img t-att-src="activity_image('res.partner', 'avatar_128', record.id.raw_value)" role="img" t-att-title="record.id.value" t-att-alt="record.id.value"/>
                    <div>
                        <field name="name" display="full"/>
                        <field name="parent_id" muted="1" display="full"/>
                    </div>
                </div>
            </templates>
        </activity>
      </field>
    </record>

    <!-- partners search -->
    <record id="partners_search" model="ir.ui.view">
      <field name="name">colpari.partners.search</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>
      <field name="arch" type="xml">
        <search string="colpari Partners">
          <field name="display_name" string="Name"/>
          <field name="colpari_login_name" string="Login Name"/>
          <field name="phone_line_number" string="Phone line number"/>
          <field name="taxId" string="Tax ID"/>
          <field name="effective_assigned_projects" string="Projects"/>
          <filter name="filter_partners" string="Partners" domain="[('is_colpari_partner', '=', True)]"/>
          <filter name="filter_clients" string="Clients" domain="[('is_colpari_client', '=', True)]"/>
          <filter name="filter_companies" string="Companies" domain="[('is_company', '=', True)]"/>
          <group expand="0" string="Group By">
              <filter name="is_colpari_partner_" string="Is partner" domain="[]" context="{'group_by': 'is_colpari_partner'}"/>
              <filter name="is_colpari_client" string="Is client" domain="[]" context="{'group_by': 'is_colpari_client'}"/>
          </group>
          <searchpanel>
            <field name="parent_id" icon="fa-users" enable_counters="1" select="one" hierarchize="true"/>
          </searchpanel>
        </search>
      </field>
    </record>


    <!-- action for partners overview -->
    <record model="ir.actions.act_window" id="act_partners_window">
      <field name="name">colpari partners</field>
      <field name="res_model">res.partner</field>
      <field name="view_mode">tree,activity,kanban,form</field>
      <field name="view_id" ref="partners_tree"/>
      <field name="context">{'default_is_colpari_client':False, 'default_is_colpari_partner':True, 'search_default_filter_partners':1}</field>
      <!-- <field name="view_id" eval="False"/> -->
      <field name="search_view_id" ref="partners_search"/>
    </record>

    <!-- action to create partner sso portal account -->
<!--     <record model="ir.actions.server" id="partner_create_sso_portal_account">
      <field name="name">(Don't use!) Grant colpari Partner Portal SSO access</field>
      <field name="model_id" ref="model_res_partner" />
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_admin'))]"/>
      <field name="binding_model_id" ref="model_res_partner"/>
      <field name="state">code</field>
      <field name="code">records._createPartnerPortalSSOAccount()</field>
    </record>
 -->
  </data>
</odoo>
