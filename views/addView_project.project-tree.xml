<?xml version="1.0"?>
<odoo>
  <data>
    <!-- projects list -->
    <record id="services_tree" model="ir.ui.view">
      <field name="name">colpari.projects.tree</field>
      <field name="model">project.project</field>
      <field name="field_parent">parent_project_id</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <tree limit="120" string="Projects" delete="0" multi_edit="0" sample="1" expand="true">
          <!-- <field name="message_needaction" optional="show"/>
          <field name="active"  optional="show"/> -->
          <field name="name" string="Name" class="font-weight-bold"/>
          <field name="colpari_client" string="Client" optional="hide"/>
          <field name="user_id" optional="hide" string="Project Manager" widget="many2one_avatar_user"/>
          <field name="parent_project_id" optional="hide" string="Parent"/>
          <field name="s2last_month_in" optional="show" attrs="{'invisible': [('last_month_in', '=', 0.0)]}" sum="Total"/>
          <field name="s2last_month_out" optional="hide" attrs="{'invisible': [('last_month_out', '=', 0.0)]}" sum="Total"/>
          <field name="s2last_month_net" optional="hide" attrs="{'invisible': [('last_month_net', '=', 0.0)]}" sum="Total"/>
          <field name="s2last_month_margin" optional="show" avg="Average"/>
          <field name="last_month_in" optional="show" attrs="{'invisible': [('last_month_in', '=', 0.0)]}" sum="Total"/>
          <field name="last_month_out" optional="hide" attrs="{'invisible': [('last_month_out', '=', 0.0)]}" sum="Total"/>
          <field name="last_month_net" optional="hide" attrs="{'invisible': [('last_month_net', '=', 0.0)]}" sum="Total"/>
          <field name="last_month_margin" optional="show" avg="Average"/>
          <field name="current_month_in" optional="show" attrs="{'invisible': [('current_month_in', '=', 0.0)]}" sum="Total"/>
          <field name="current_month_out" optional="hide" attrs="{'invisible': [('current_month_out', '=', 0.0)]}" sum="Total"/>
          <field name="current_month_net" optional="hide" attrs="{'invisible': [('current_month_net', '=', 0.0)]}" sum="Total"/>
          <field name="current_month_margin" optional="show" avg="Average"/>
          <field name="current_year_in" optional="show" attrs="{'invisible': [('current_year_in', '=', 0.0)]}" sum="Total"/>
          <field name="current_year_out" optional="hide" attrs="{'invisible': [('current_year_out', '=', 0.0)]}" sum="Total"/>
          <field name="current_year_net" optional="hide" attrs="{'invisible': [('current_year_net', '=', 0.0)]}" sum="Total"/>
          <field name="current_year_margin" optional="show"  avg="Average"/>
          <field name="accounting_interval" optional="hide"/>
          <field name="privacy_visibility" optional="hide"/>
          <field name="analytic_account_id" optional="hide"/>
          <field name="account_child_projects" optional="hide"/>
          <field name="colpari_currency_id" invisible="1"/>
          <!-- <field name="subtask_project_id" optional="hide"/>
          <field name="label_tasks" optional="hide"/>
          <field name="company_id" optional="hide" groups="base.group_multi_company"/> -->
        </tree>
      </field>
    </record>

    <!-- projects search -->
    <record id="services_search" model="ir.ui.view">
      <field name="name">colpari.projects.search</field>
      <field name="model">project.project</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <search string="colpari Projecxx">
          <field name="name" />
          <field name="parent_project_id" icon="fa-users"/>
          <group expand="0" string="Group By">
              <filter name="parent_project_id" string="Parent project" domain="[]" context="{'group_by': 'parent_project_id'}"/>
          </group>
          <searchpanel>
            <field name="parent_project_id" icon="fa-users" select="one" hierarchize="True" enable_counters="True"/>
            <!-- domain="[('parent_project_id', '=', False)]" -->
            <field name="partner_id" icon="fa-users" enable_counters="1" select="one" hierarchize="true"/>
            <!-- <field name="user_id" icon="fa-users" enable_counters="1" select="one" hierarchize="true"/> -->
          </searchpanel>
        </search>
      </field>
    </record>

    <!-- action for projects overview -->
    <record model="ir.actions.act_window" id="act_projects_window">
      <field name="name">colpari projects</field>
      <field name="res_model">project.project</field>
      <field name="view_mode">tree,kanban,form</field>
      <field name="view_id" ref="services_tree"/> 
      <field name="search_view_id" ref="services_search"/>
      <!-- <field name="domain">[('parent_project_id','=', False)]</field> -->
    </record>
  </data>
</odoo>