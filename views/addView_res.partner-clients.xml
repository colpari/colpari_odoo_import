<?xml version="1.0"?>
<odoo>
  <data>
    <!-- clients list -->
    <record id="clients_tree" model="ir.ui.view">
      <field name="name">colpari.clients.tree</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <tree limit="120" string="colpari Clients" delete="0" multi_edit="0" sample="1" expand="true">
          <field name="display_name" string="Name"/>
          <field name="email" optional="show"/>
          <field name="phone" class="o_force_ltr" optional="show"/>
          <field name="user_id" optional="show" widget="many2one_avatar_user" domain="[('share', '=', False)]"/>
          <field name="vat" optional="hide" readonly="1"/>
          <field name="category_id" optional="hide" widget="many2many_tags" options="{'color_field': 'color'}"/>
          <field name="company_id" groups="base.group_multi_company" readonly="1"/>
          <field name="is_company" optional="show"/>
          <field name="parent_id" optional="show"/>
          <field name="active" optional="show"/>
          <field name="city" optional="hide"/>
          <field name="state_id" optional="hide" readonly="1"/>
          <field name="country_id" optional="hide" readonly="1"/>
        </tree>
      </field>
    </record>


    <!-- activity view -->
    <record id="client_activity" model="ir.ui.view">
      <field name="name">colpari.client.activity</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <activity string="Contacts">
            <field name="id"/>
            <templates>
                <div t-name="activity-box">
                    <img t-att-src="activity_image('res.partner', 'avatar_128', record.id.raw_value)" role="img" t-att-title="record.id.value" t-att-alt="record.id.value"/>
                    <div>
                        <field name="name" display="full"/>
                        <field name="parent_id" muted="1" display="full"/>
                    </div>
                </div>
            </templates>
        </activity>
      </field>
    </record>

    <!-- clients search -->
    <record id="clients_search" model="ir.ui.view">
      <field name="name">colpari.clients.search</field>
      <field name="model">res.partner</field>
      <field name="groups_id" eval="[(4, ref('colpari_services.group_colpari_user'))]"/>      
      <field name="arch" type="xml">
        <search string="colpari Clients">
          <field name="display_name" string="Name"/>
          <filter name="filter_partners" string="Partners" domain="[('is_colpari_partner', '=', True)]"/>
          <filter name="filter_clients" string="Clients" domain="[('is_colpari_client', '=', True)]"/>
          <filter name="filter_companies" string="Clients" domain="[('is_company', '=', True)]"/>
          <group expand="0" string="Group By">
              <filter name="is_colpari_client" string="Is client" domain="[]" context="{'group_by': 'is_colpari_client'}"/>
              <filter name="is_colpari_partner" string="Is partner" domain="[]" context="{'group_by': 'is_colpari_partner'}"/>
          </group>
          <searchpanel>
            <field name="parent_id" icon="fa-users" enable_counters="1" select="one" hierarchize="true"/>
          </searchpanel>
        </search>
      </field>
    </record>


    <!-- action for clients overview -->
    <record model="ir.actions.act_window" id="act_clients_window">
      <field name="name">colpari clients</field>
      <field name="res_model">res.partner</field>
      <field name="view_mode">tree,activity,kanban,form</field>
      <field name="view_id" ref="clients_tree"/>
      <field name="context">{'default_is_colpari_client':True, 'default_is_colpari_partner':False, 'search_default_filter_clients':1}</field>
      <field name="search_view_id" ref="clients_search"/>
    </record>

  </data>
</odoo>